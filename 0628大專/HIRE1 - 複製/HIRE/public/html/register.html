<!DOCTYPE html>
<html>

<head>
  <title>帳號註冊</title>
  <link rel="stylesheet" href="../css/register.css">
  <script src="https://code.jquery.com/jquery-3.7.0.js" integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM=" crossorigin="anonymous"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <!-- <script src="./register.js"></script> -->
</head>

<body onload="initGoogleSignIn()">
  <div class="box_1">
    <div></div>
    <div id="page1">
      <form>
        <p class="title_1">註冊</p>
        <label for="username">帳號:</label>
        <input type="text"
         id="username" 
         name="username" 
         onblur="checkUsernameAvailability()" 
         title="僅接受英文字母、數字、以及「 _ 」與「 - 」符號的組合，最短6個，最長12個字元。不可含有符號如「@」、「&」、「%」、「!」、「$」、「^」、「*」、「‘」、「<」等等，或空格或跳位字元。"
         required>
        <span id="usernameAvailability">&nbsp</span>

    

        <label for="password" >密碼:</label>
        <input type="password"  id="password" name="password" onblur="c1()" title="密碼6 ~ 15 字元，至少搭配 1 個英文字母
        " required>
        <span id="passwordName">&nbsp</span>

        <label for="confirmPassword">再次輸入密碼:</label>
        <input type="password" id="confirmPassword" name="confirmPassword" onblur="Cheak()" required>
        <span id="doubleCheak">&nbsp</span>

        <div class="navigation-buttons">
          <button id="nextButton" type="button" onclick="goToNextPage()" disabled>下一步</button>
        </div>

        <div id="google-signin-button" class="google-login-box"></div>
      </form>
    </div>

    <div id="page2">
      <form onsubmit="submitForm()">
        <h1 class="title_1">註冊</h1>
        <label for="name">姓名/暱稱:</label>
        <input type="text" id="name" name="name" required>

        <label for="idNumber">身分證:</label>
        <input type="text" id="idNumber" name="idNumber" onblur="idNumberCheak()" required>
        <span id="idNumbertext">&nbsp</span>


        <label for="birthdate">生日:</label>
        <input type="date" id="birthdate" name="birthdate" required>

        <label for="phone">手機:</label>
        <input type="tel" id="phone" name="phone" onblur="phoneCheak()" required>
        <span id="phonetext">&nbsp</span>

        <label for="email">電子信箱:</label>
        <input type="email" id="email" name="email" required>

        <div class="navigation-buttons">
          <button type="button" onclick="goToPreviousPage()">上一步</button>
          <button type="submit">註冊</button>
        </div>
      </form>
    </div>

  </div>
  <script>
      // 帳號可用性
  function checkUsernameAvailability() {
    var username = document.getElementById("username").value;
    var okk = /^[a-zA-Z0-9_-]{6,12}$/;//沒符號
    if (okk.test(username)) {
      document.getElementById('usernameAvailability').textContent = '帳號可用';
      // document.getElementById('nextButton').disabled = false;
      sessionStorage.setItem("username", username);
    } else {
      document.getElementById('usernameAvailability').textContent = '帳號不可用';
      document.getElementById('nextButton').disabled = true;
    }


  }
  //密碼
  function c1() {
    var password = document.getElementById("password").value;
    let regex = /^(?=.*[a-zA-Z])[a-zA-Z0-9]{6,15}$/;
    if (!regex.test(password)) {
      document.getElementById('nextButton').disabled = true;
      document.getElementById('passwordName').textContent = "請符合命名規則 ";
    } else {
      document.getElementById('passwordName').textContent = "ok ";
      sessionStorage.setItem("password", password);
    }
  }
  function Cheak() {

    var password = document.getElementById("password").value;
    var confirmPassword = document.getElementById("confirmPassword").value;

    if (password !== confirmPassword) {
      document.getElementById('nextButton').disabled = true;
      doubleCheak.textContent = "兩次輸入密碼不一致"
    } else {
      document.getElementById('nextButton').disabled = false;
      doubleCheak.textContent = " "
    }
  }

  // 下一步按鈕點擊事件處理函式
  function goToNextPage() {
    // 在這裡執行跳轉到下一步的操作
    console.log('下一步');
  }



  // 跳至第二頁的函式
  function goToNextPage() {
    // 隱藏第一頁的元素
    document.getElementById("page1").style.display = "none";

    // 顯示第二頁的元素
    document.getElementById("page2").style.display = "block";
  }

  // 回到上一步的函式
  function goToPreviousPage() {
    // 隱藏第二頁的元素
    document.getElementById("page2").style.display = "none";

    // 顯示第一頁的元素
    document.getElementById("page1").style.display = "block";
  }

  // 初始化 Google Sign-In 按鈕
  function initGoogleSignIn() {
    google.accounts.id.initialize({
      client_id: 'CLIENT_ID.apps.googleusercontent.com',
      callback: handleGoogleSignIn,
      auto_select: true,
      prompt_parent_id: 'google-signin-button'
    });
    google.accounts.id.renderButton(document.getElementById('google-signin-button'), {
      theme: 'filled_black',
      size: 'large',
      text: '使用Google帳號註冊',
      width: 'auto',
      height: '42'
    });
  }

  // 處理 Google Sign-In 回應
  function handleGoogleSignIn(response) {
    // 在此處理 Google Sign-In 回應
    console.log(response);
  }

  //將1.2頁資料一起submit出去
  function submitForm() {
    var username = sessionStorage.getItem("username");
    var password = sessionStorage.getItem("password");

    var name = document.getElementById("name").value;
    var idNumber = document.getElementById("idNumber").value;
    var birthdate = document.getElementById("birthdate").value;
    var phone = document.getElementById("phone").value;
    var email = document.getElementById("email").value;

    var message = "帳號: " + username + "\n" +
      "密碼: " + password + "\n" +
      "姓名/暱稱: " + name + "\n" +
      "身分證: " + idNumber + "\n" +
      "生日: " + birthdate + "\n" +
      "手機: " + phone + "\n" +
      "電子信箱: " + email;
    alert(message);
  }

  // 第二頁
  function phoneCheak() {
    const phoneregex = /^09[0-9]{8}$/;
    var phone = document.getElementById('phone').value;
    if (!phoneregex.test(phone)) {
      document.getElementById('nextButton').disabled = true;
      document.getElementById('phonetext').textContent = "請輸入正確資訊";
    } else {
      document.getElementById('phonetext').textContent = "ok ";
    }
  }

  function idNumberCheak() {
    const idNumberregex = /^[A-Za-z][12]\d{8}$/;
    var idNumber = document.getElementById('idNumber').value;
    if (!idNumberregex.test(idNumber)) {
      document.getElementById('nextButton').disabled = true;
      document.getElementById('idNumbertext').textContent = "請輸入正確資訊";
    } else {
      document.getElementById('idNumbertext').textContent = "ok ";
    }
  }
  </script>
</body>

</html>